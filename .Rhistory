library(mapview)
library(rasterVis)
source("functions.R")
mapview::mapviewOptions(fgb = FALSE)
zinc_map <- suppressMessages(
suppressWarnings(
zinc_kriging()
)
)
na.color <- "#FFFFFF00"
m2 <- suppressWarnings(
mapview(
x = zinc_map[[1]],
alpha.regions = 1,
legend = TRUE,
na.color = na.color,
layer.name = "prediction"
)
)
m3 <- suppressWarnings(
mapview(
x = zinc_map[[2]],
alpha.regions = 1,
legend = TRUE,
na.color = na.color,
layer.name = "variance"
)
)
m4 <- m3 + m2
m4@map
zinc_map[[1]]
raster::rasterToPolygons(zinc_map[[1]])
m2 <- suppressWarnings(
mapview(
x = zinc_map[[1]] %>% rasterToPolygons,
alpha.regions = 1,
legend = TRUE,
na.color = na.color,
layer.name = "prediction"
)
)
m2
lineWidth(x)
m2 <- suppressWarnings(
mapview(
x = zinc_map[[1]] %>% rasterToPolygons,
alpha.regions = 1,
lwd = 0,
legend = TRUE,
na.color = na.color,
layer.name = "prediction"
)
)
m2
m3 <- suppressWarnings(
mapview(
x = zinc_map[[2]] %>% rasterToPolygons,
alpha.regions = 1,
legend = TRUE,
lwd = 0,
na.color = na.color,
layer.name = "variance"
)
)
m4 <- m3 + m2
m4@map
m4 <- m3 | m2
m4@map
zinc_map2_sp <- zinc_map[[2]] %>% rasterToPolygons
zinc_map2_sp
zinc_map2_sp$var1.var
zinc_map2_sp_msg <- sprintf("<strong>variance:</strong>%s", zinc_map2_sp$var1.var)
zinc_map2_sp_msg
zinc_map2_sp <- zinc_map[[2]] %>% rasterToPolygons
zinc_map2_sp$msg <- sprintf("<strong>variance:</strong>%s", zinc_map2_sp$var1.var)
zinc_map2_sp
zinc_map2_sp
m3 <- suppressWarnings(
mapview(
x = zinc_map2_sp["msg"],
alpha.regions = 1,
legend = TRUE,
lwd = 0,
na.color = na.color,
layer.name = "variance"
)
)
m3
zinc_map2_sp$msg <- sprintf("<b>variance:</b>%s", zinc_map2_sp$var1.var)
zinc_map2_sp
zinc_map2_sp <- zinc_map[[2]] %>% rasterToPolygons
zinc_map2_sp$msg <- sprintf("<b>variance:</b>%s", zinc_map2_sp$var1.var)
zinc_map2_sp
zinc_map2_sp$msg
m3 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
zcol = "var1.var",
alpha.regions = 1,
legend = TRUE,
lwd = 0,
na.color = na.color,
layer.name = "variance"
)
)
m3
m3 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
zcol = "var1.var",
alpha.regions = 1,
legend = TRUE,
lwd = 0,
popup = TRUE,
na.color = na.color,
layer.name = "variance"
)
)
m3
zinc_map2_sp
zinc_map2_sp <- zinc_map[[2]] %>% rasterToPolygons
zinc_map2_sp
names(zinc_map2_sp)
names(zinc_map2_sp) <- "variance"
zinc_map2_sp <- zinc_map[[1]] %>% rasterToPolygons
zinc_map2_sp
zinc_map2_sp <- zinc_map[[1]] %>% rasterToPolygons
names(zinc_map2_sp) <- "prediction"
m2 <- suppressWarnings(
mapview(
x = zinc_map[[1]] %>% rasterToPolygons,
alpha.regions = 1,
lwd = 0,
legend = TRUE,
na.color = na.color,
layer.name = "prediction"
)
)
zinc_map2_sp <- zinc_map[[2]] %>% rasterToPolygons
names(zinc_map2_sp) <- "variance"
m3 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
zcol = "var1.var",
alpha.regions = 1,
legend = TRUE,
lwd = 0,
popup = TRUE,
na.color = na.color,
layer.name = "variance"
)
)
m4 <- m2 | m3
m3 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
alpha.regions = 1,
legend = TRUE,
lwd = 0,
popup = TRUE,
na.color = na.color,
layer.name = "variance"
)
)
m4 <- m2 | m3
m4@map
zinc_map2_sp <- zinc_map[[1]] %>% rasterToPolygons
zinc_map2_sp
names(zinc_map2_sp) <- "prediction"
zinc_map2_sp
m2 <- suppressWarnings(
mapview(
x = zinc_map[[1]] %>% rasterToPolygons,
alpha.regions = 1,
lwd = 0,
legend = TRUE,
na.color = na.color,
layer.name = "prediction"
)
)
m2
m2 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
alpha.regions = 1,
lwd = 0,
legend = TRUE,
na.color = na.color,
layer.name = "prediction"
)
)
m2
zinc_map2_sp <- zinc_map[[2]] %>% rasterToPolygons
zinc_map2_sp <- zinc_map[[2]] %>% rasterToPolygons
names(zinc_map2_sp) <- "variance"
m3 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
alpha.regions = 1,
legend = TRUE,
lwd = 0,
popup = TRUE,
na.color = na.color,
layer.name = "variance"
)
)
m4 <- m2 | m3
m4@map
zinc_map2_sp <- zinc_map %>% rasterToPolygons
zinc_map2_sp
zinc_map2_sp <- zinc_map %>% rasterToPolygons
names(zinc_map2_sp) <- c("prediction", "variance")
m2 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
zcol = "prediction",
alpha.regions = 1,
lwd = 0,
legend = TRUE,
na.color = na.color,
layer.name = "prediction"
)
)
m3 <- suppressWarnings(
mapview(
x = zinc_map2_sp,
zcol = "variance",
alpha.regions = 1,
legend = TRUE,
lwd = 0,
popup = TRUE,
na.color = na.color,
layer.name = "variance"
)
)
m4 <- m2 | m3
m4@map
npoints_importance <- zinc_kriging_cv_npoints()
npoints_importance
gg1 <- ggplot(npoints_importance) +
geom_line(aes(x=npoints, y=error), cex=2)+
geom_point(aes(x=npoints, y=error), cex=4.5)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
ggplotly(gg1)
meuse <- create_meuse()
n_points <- c(25, 50,75,100,125,155)
rmse_values_boostrap <- NULL
rmse_values_boostrap
variable <- 1
rmse_values <- NULL
for (n_point in n_points) {
meuse_sample <- meuse[sample(nrow(meuse),n_point),]
lzn_vgm <- variogram(log(zinc)~1, meuse_sample)
lzn_fit <- fit.variogram(lzn_vgm, model = vgm(1, "Sph", 900, 1))
lzn.kriged <- krige.cv(log(zinc)~1, meuse_sample, nfold = 5, verbose	= 0)
crs(lzn.kriged) <- crs(meuse)
rmse_values <- append(rmse_values, mean(lzn.kriged$residual**2))
}
rmse_values_boostrap <- rbind(rmse_values_boostrap, rmse_values)
rmse_values_boostrap
meuse <- create_meuse()
n_points <- c(25, 50,75,100,125,155)
rmse_values_boostrap <- NULL
for (variable in 1:10) {
rmse_values <- NULL
for (n_point in n_points) {
meuse_sample <- meuse[sample(nrow(meuse),n_point),]
lzn_vgm <- variogram(log(zinc)~1, meuse_sample)
lzn_fit <- fit.variogram(lzn_vgm, model = vgm(1, "Sph", 900, 1))
lzn.kriged <- krige.cv(log(zinc)~1, meuse_sample, nfold = 5, verbose	= 0)
crs(lzn.kriged) <- crs(meuse)
rmse_values <- append(rmse_values, mean(lzn.kriged$residual**2))
}
rmse_values_boostrap <- rbind(rmse_values_boostrap, rmse_values)
}
rmse_values_boostrap
final_values <- apply(rmse_values_boostrap,2,mean)
data.frame(npoints = n_points, error = final_values)
final_values
rmse_values_boostrap
data.frame(npoints = n_points, error = rmse_values_boostrap)
final_values
rmse_values_boostrap
data.frame(npoints = n_points, error = rmse_values_boostrap)
data.frame(npoints = n_points, error = rmse_values_boostrap %>% t)
zinc_kriging_cv_npoints <- function() {
meuse <- create_meuse()
n_points <- c(25, 50,75,100,125,155)
rmse_values_boostrap <- NULL
for (variable in 1:100) {
rmse_values <- NULL
for (n_point in n_points) {
meuse_sample <- meuse[sample(nrow(meuse),n_point),]
lzn_vgm <- variogram(log(zinc)~1, meuse_sample)
lzn_fit <- fit.variogram(lzn_vgm, model = vgm(1, "Sph", 900, 1))
lzn.kriged <- krige.cv(log(zinc)~1, meuse_sample, nfold = 5, verbose	= 0)
crs(lzn.kriged) <- crs(meuse)
rmse_values <- append(rmse_values, mean(lzn.kriged$residual**2))
}
rmse_values_boostrap <- rbind(rmse_values_boostrap, rmse_values)
}
final_values <- apply(rmse_values_boostrap,2,mean)
data.frame(npoints = n_points, error = rmse_values_boostrap %>% t)
}
npoints_importance <- zinc_kriging_cv_npoints()
npoints_importance
npoints_importance
library(tidyverse)
npoints_importance
npoints_importance %>% pivot_longer()
npoints_importance %>%
pivot_longer(!npoints, names_to = "rmse", values_to = "values")
npoints_importance_melt <- npoints_importance %>%
pivot_longer(!npoints, names_to = "rmse", values_to = "values")
npoints_importance_melt
gg1 <- ggplot(npoints_importance) +
geom_point(aes(x=npoints, y=error), cex=4.5)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
npoints_importance_melt
gg1 <- ggplot(npoints_importance) +
geom_point(aes(x=npoints, y=values, group = rmse), cex=4.5)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
npoints_importance
npoints_importance_melt
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = rmse), cex=4.5)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
ggplotly(gg1)
gg1
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = rmse), cex=1)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = rmse), cex=1,alpha=0.6)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = rmse), cex=1,alpha=0.3)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
ggplotly(gg1)
npoints_importance
npoints_importance
colnames(npoints_importance)
c("npoints", sprintf("experiment_%03d",1:100))
colnames(npoints_importance) <- c("npoints", sprintf("experiment_%03d",1:100))
npoints_importance_melt <- npoints_importance %>%
pivot_longer(!npoints, names_to = "experiment", values_to = "values")
npoints_importance_melt
npoints_importance_melt <- npoints_importance %>%
pivot_longer(!npoints, names_to = "experiments", values_to = "values")
npoints_importance_melt
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = rmse), cex=1,alpha=0.3)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
npoints_importance
npoints_importance
npoints_importance
npoints_importance[-1]
colnames(npoints_importance[-1])[1]
apply(npoints_importance[-1], 2, mean)
zinc_kriging_cv_npoints <- function() {
meuse <- create_meuse()
n_points <- c(25, 50,75,100,125,155)
rmse_values_boostrap <- NULL
for (variable in 1:100) {
rmse_values <- NULL
for (n_point in n_points) {
meuse_sample <- meuse[sample(nrow(meuse),n_point),]
lzn_vgm <- variogram(log(zinc)~1, meuse_sample)
lzn_fit <- fit.variogram(lzn_vgm, model = vgm(1, "Sph", 900, 1))
lzn.kriged <- krige.cv(log(zinc)~1, meuse_sample, nfold = 5, verbose	= 0)
crs(lzn.kriged) <- crs(meuse)
rmse_values <- append(rmse_values, mean(lzn.kriged$residual**2))
}
rmse_values_boostrap <- rbind(rmse_values_boostrap, rmse_values)
}
final_values <- apply(rmse_values_boostrap,2,mean)
data.frame(npoints = n_points, error = rmse_values_boostrap %>% t)
}
apply(npoints_importance[-1], 1, mean)
npoints_importance
npoints_importance[11]
npoints_importance[1]
apply(npoints_importance[-1], 1, mean)
npoints_importance_mean <- npoints_importance[1]
npoints_importance_mean$mean_exp <- apply(npoints_importance[-1], 1, mean)
npoints_importance_mean
npoints_importance_mean
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
geom_line(data = npoints_importance_mean, aes(x, npoints, y = mean_exp)) +
geom_point(data = npoints_importance_mean, aes(x, npoints, y = mean_exp)) +
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
geom_line(data = npoints_importance_mean, aes(x = npoints, y = mean_exp)) +
geom_point(data = npoints_importance_mean, aes(x = npoints, y = mean_exp)) +
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
gg1
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
geom_line(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 3) +
geom_point(data = npoints_importance_mean, aes(x = npoints, y = mean_exp)) +
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
ggplotly(gg1)
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
geom_line(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 2) +
geom_point(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 2) +
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
ggplotly(gg1)
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
geom_line(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 2) +
geom_point(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 3) +
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
ggplotly(gg1)
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
geom_line(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 1) +
geom_point(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 3) +
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
ggplotly(gg1)
rmse_values_boostrap
data.frame(npoints = n_points, error = rmse_values_boostrap %>% t)
zinc_kriging_cv_npoints <- function() {
meuse <- create_meuse()
n_points <- c(25, 50,75,100,125,155)
rmse_values_boostrap <- NULL
for (variable in 1:100) {
rmse_values <- NULL
for (n_point in n_points) {
meuse_sample <- meuse[sample(nrow(meuse),n_point),]
lzn_vgm <- variogram(log(zinc)~1, meuse_sample)
lzn_fit <- fit.variogram(lzn_vgm, model = vgm(1, "Sph", 900, 1))
lzn.kriged <- krige.cv(log(zinc)~1, meuse_sample, nfold = 5, verbose	= 0)
crs(lzn.kriged) <- crs(meuse)
rmse_values <- append(rmse_values, mean(lzn.kriged$residual**2))
}
rmse_values_boostrap <- rbind(rmse_values_boostrap, rmse_values)
}
data.frame(npoints = n_points, error = rmse_values_boostrap %>% t)
}
library(sp)
library(sf)
library(gstat)
library(plotly)
library(raster)
library(leaflet)
library(ggplot2)
library(mapview)
library(rasterVis)
library(tidyverse)
source("functions.R")
mapview::mapviewOptions(fgb = FALSE)
npoints_importance <- zinc_kriging_cv_npoints()
npoints_importance_mean <- npoints_importance[1]
npoints_importance_mean$mean_exp <- apply(npoints_importance[-1], 1, mean)
colnames(npoints_importance) <- c("npoints", sprintf("experiment_%03d",1:100))
npoints_importance_melt <- npoints_importance %>%
pivot_longer(!npoints, names_to = "experiments", values_to = "values")
gg1 <- ggplot(npoints_importance_melt) +
geom_point(aes(x=npoints, y=values, group = experiments), cex=1,alpha=0.3)+
geom_line(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 1) +
geom_point(data = npoints_importance_mean, aes(x = npoints, y = mean_exp), cex = 3) +
xlab("Number of points") +
ylab("RMSE") +
theme_bw()
ggplotly(gg1)
sample(10,4)
sample(10,4)
sample(10,4, replace = TRUE)
